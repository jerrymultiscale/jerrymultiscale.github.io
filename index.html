<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Lato:300,300italic,400,400italic,700,700italic|Playball:300,300italic,400,400italic,700,700italic|Droid Sans Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Memories" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="Loneliness can ruin one, or opppositely boom one.">
<meta property="og:type" content="website">
<meta property="og:title" content="Memories">
<meta property="og:url" content="http://www.jiaxm.me/index.html">
<meta property="og:site_name" content="Memories">
<meta property="og:description" content="Loneliness can ruin one, or opppositely boom one.">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Memories">
<meta name="twitter:description" content="Loneliness can ruin one, or opppositely boom one.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post","offset":15,"offset_float":0,"b2t":false,"scrollpercent":true},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.jiaxm.me/"/>





  <title>Memories</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-102501818-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0023e706cb9578232593ba36ca71a490";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










<link rel="stylesheet" href="/css/prism-coy.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Memories</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">a corner of the world</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/Links/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-link"></i> <br />
            
            Links
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.jiaxm.me/2017-07-day/Hexo Configuration/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jxm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-07-day/Hexo Configuration/" itemprop="url">Hexo Configuration</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-13T19:40:00+08:00">
                2017-07-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hexo/" itemprop="url" rel="index">
                    <span itemprop="name">hexo</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017-07-day/Hexo Configuration/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017-07-day/Hexo Configuration/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。本文为Hexo相关的东西，大部分与特性配置有关。
&lt;!--more--&gt;</p>
<h1 id="特性配置"><a href="#特性配置" class="header-anchor"></a>1. <a href="#u7279_u6027_u914D_u7F6E" class="headerlink" title="特性配置"></a>特性配置</h1><h2 id="添加邮箱链接控制"><a href="#添加邮箱链接控制" class="header-anchor"></a>1.1. <a href="#u6DFB_u52A0_u90AE_u7BB1_u94FE_u63A5_u63A7_u5236" class="headerlink" title="添加邮箱链接控制"></a>添加邮箱链接控制</h2><p>安装插件<code>hexo-email-obfuscate</code>，参考<a href="https://www.npmjs.com/package/hexo-email-obfuscate" target="_blank" rel="external">这里</a>
<code>sh
npm install hexo-email-obfuscate --save</code>
在站点配置文件<code>_config.yml</code>中加入：
<code>css
plugins:
  - hexo-email-obfuscate</code>
使用语法：
Markdown
<code>[Contact Me](mailto:foo@bar.com)</code></p>
<h2 id="文章中添加居中模块"><a href="#文章中添加居中模块" class="header-anchor"></a>1.2. <a href="#u6587_u7AE0_u4E2D_u6DFB_u52A0_u5C45_u4E2D_u6A21_u5757" class="headerlink" title="文章中添加居中模块"></a>文章中添加居中模块</h2><p>文章Markdown中填写如下：
```css</p>
<p>&lt;blockquote class=&quot;blockquote-center&quot;&gt;优秀的人，不是不合群，而是他们合群的人里面没有你&lt;/blockquote&gt;
```</p>
<h2 id="隐藏网页底部powered-by-hexo-强力驱动"><a href="#隐藏网页底部powered-by-hexo-强力驱动" class="header-anchor"></a>1.3. <a href="#u9690_u85CF_u7F51_u9875_u5E95_u90E8powered_By_Hexo_/__u5F3A_u529B_u9A71_u52A8" class="headerlink" title="隐藏网页底部powered By Hexo / 强力驱动"></a>隐藏网页底部powered By Hexo / 强力驱动</h2><p>打开themes/next/layout/_partials/footer.swig,使用””隐藏之间的代码即可，或者直接删除。</p>
<h2 id="友情链接设置"><a href="#友情链接设置" class="header-anchor"></a>1.4. <a href="#u53CB_u60C5_u94FE_u63A5_u8BBE_u7F6E" class="headerlink" title="友情链接设置"></a>友情链接设置</h2><p>编辑站点的 _config.yml 添加：
```</p>
<h1 id="title-chinese-available"><a href="#title-chinese-available" class="header-anchor"></a>2. <a href="#title_2C_chinese_available" class="headerlink" title="title, chinese available"></a>title, chinese available</h1><p>links_title: Links</p>
<h1 id="links"><a href="#links" class="header-anchor"></a>3. <a href="#links" class="headerlink" title="links"></a>links</h1><p>links:
  MacTalk: http://macshuo.com/
```</p>
<h2 id="代码高亮prism"><a href="#代码高亮prism" class="header-anchor"></a>3.1. <a href="#u4EE3_u7801_u9AD8_u4EAEprism" class="headerlink" title="代码高亮prism"></a>代码高亮prism</h2><p>由<a href="https://github.com/wayou/hexo-prism" target="_blank" rel="external">wayou</a>开发，代替hexo原生代码高亮。</p>
<h3 id="install"><a href="#install" class="header-anchor"></a>3.1.1. <a href="#Install_3A" class="headerlink" title="Install:"></a>Install:</h3><p><code>sh
npm i -S hexo-prism-plugin</code></p>
<h3 id="usage"><a href="#usage" class="header-anchor"></a>3.1.2. <a href="#Usage_3A" class="headerlink" title="Usage:"></a>Usage:</h3><p>编辑站点配置文件<code>_config.yml</code>，加入
```css</p>
<h3 id="prism_plugin"><a href="#prism_plugin" class="header-anchor"></a>3.1.3. <a href="#prism_plugin" class="headerlink" title="prism_plugin"></a>prism_plugin</h3><p>prism_plugin:
  mode: ‘preprocess’    # realtime or preprocess
  theme: ‘default’</p>
<h1 id="theme-coy"><a href="#theme-coy" class="header-anchor"></a>4.1. <a href="#theme_3A__u2018coy_u2019" class="headerlink" title="theme: ‘coy’"></a>theme: ‘coy’</h1><h1 id="theme-dark"><a href="#theme-dark" class="header-anchor"></a>5.1. <a href="#theme_3A__u2018dark_u2019" class="headerlink" title="theme: ‘dark’"></a>theme: ‘dark’</h1><h1 id="theme-funky"><a href="#theme-funky" class="header-anchor"></a>6.1. <a href="#theme_3A__u2018funky_u2019" class="headerlink" title="theme: ‘funky’"></a>theme: ‘funky’</h1><h1 id="theme-okaidia"><a href="#theme-okaidia" class="header-anchor"></a>7.1. <a href="#theme_3A__u2018okaidia_u2019" class="headerlink" title="theme: ‘okaidia’"></a>theme: ‘okaidia’</h1><h1 id="theme-solarizedlight"><a href="#theme-solarizedlight" class="header-anchor"></a>8.1. <a href="#theme_3A__u2018solarizedlight_u2019" class="headerlink" title="theme: ‘solarizedlight’"></a>theme: ‘solarizedlight’</h1><h1 id="theme-tomorrow"><a href="#theme-tomorrow" class="header-anchor"></a>9.1. <a href="#theme_3A__u2018tomorrow_u2019" class="headerlink" title="theme: ‘tomorrow’"></a>theme: ‘tomorrow’</h1><h1 id="theme-twilight"><a href="#theme-twilight" class="header-anchor"></a>10.1. <a href="#theme_3A__u2018twilight_u2019" class="headerlink" title="theme: ‘twilight’"></a>theme: ‘twilight’</h1><p>  line_number: true   # default false
  auto_import_assets: true   # default true
```</p>
<h3 id="代码高亮主题测试"><a href="#代码高亮主题测试" class="header-anchor"></a>10.1.1. <a href="#u4EE3_u7801_u9AD8_u4EAE_u4E3B_u9898_u6D4B_u8BD5" class="headerlink" title="代码高亮主题测试"></a>代码高亮主题测试</h3><p>default:
<img src="http://res.cloudinary.com/jiaxm/image/upload/v1500807063/default_kglgrh.jpg" alt="">
coy:
<img src="http://res.cloudinary.com/jiaxm/image/upload/v1500807063/coy_vjozcy.jpg" alt="">
dark:
<img src="http://res.cloudinary.com/jiaxm/image/upload/v1500807063/dark_lxldep.jpg" alt="">
funky:
<img src="http://res.cloudinary.com/jiaxm/image/upload/v1500807064/funky_bvxgwk.jpg" alt="">
okaidia:
<img src="http://res.cloudinary.com/jiaxm/image/upload/v1500807064/okaidia_jtwjxz.jpg" alt="">
solarizedlight:
<img src="http://res.cloudinary.com/jiaxm/image/upload/v1500807064/Solariedlight_d6h4xb.jpg" alt="">
tomorrow:
<img src="http://res.cloudinary.com/jiaxm/image/upload/v1500807064/tomorrow_liekgg.jpg" alt="">
twilight:
<img src="http://res.cloudinary.com/jiaxm/image/upload/v1500807064/twilight_wlpsfk.jpg" alt="">
note:感觉有些主题怪怪的~~~</p>
<h2 id="文章内插入图片"><a href="#文章内插入图片" class="header-anchor"></a>10.2. <a href="#u6587_u7AE0_u5185_u63D2_u5165_u56FE_u7247" class="headerlink" title="文章内插入图片"></a>文章内插入图片</h2><p>在文章中写入:
<code>json
![](/upload_image/1.jpg)</code>
然后进入themes-主题名-source-upload_image目录下(自己创建)，将图片放到这个目录下，就可以了。</p>
<blockquote>
<p>说明：当执行hexo g命令时，会自动把图片复制到 public文件的upload_image目录下。</p>
</blockquote>
<h2 id="鼠标点击小红心的设置"><a href="#鼠标点击小红心的设置" class="header-anchor"></a>10.3. <a href="#u9F20_u6807_u70B9_u51FB_u5C0F_u7EA2_u5FC3_u7684_u8BBE_u7F6E" class="headerlink" title="鼠标点击小红心的设置"></a>鼠标点击小红心的设置</h2><p>将 <a href="https://github.com/Neveryu/Neveryu.github.io/blob/master/js/src/love.js" target="_blank" rel="external">love.js</a> 文件添加到 \themes\next\source\js\src 文件目录下。
找到 \themes\next\layout_layout.swing 文件， 在文件的后面， 标签之前 添加以下代码：
```js
&lt;!-- 页面点击小红心 --&gt;</p>
<p>&lt;script type=&quot;text/javascript&quot; src=&quot;/js/src/love.js&quot;&gt;&lt;/script&gt;
```</p>
<h2 id="修改文章内链接文本样式"><a href="#修改文章内链接文本样式" class="header-anchor"></a>10.4. <a href="#u4FEE_u6539_u6587_u7AE0_u5185_u94FE_u63A5_u6587_u672C_u6837_u5F0F" class="headerlink" title="修改文章内链接文本样式"></a>修改文章内链接文本样式</h2><p>将链接文本设置为蓝色，鼠标划过时文字颜色加深，并显示下划线。
找到文件 themes\next\source\css_custom\custom.styl ，添加如下 css 样式：
<code>css
.post-body p a {
  color: #0593d3;
  border-bottom: none;
  &amp;:hover {
    color: #0477ab;
    text-decoration: underline;
  }
}</code></p>
<h2 id="设置字体"><a href="#设置字体" class="header-anchor"></a>10.5. <a href="#u8BBE_u7F6E_u5B57_u4F53" class="headerlink" title="设置字体"></a>设置字体</h2><blockquote>
<p>note: 此特性在版本 5.0.1 中引入，要使用此功能请确保所使用的 NexT 版本在此之后</p>
</blockquote>
<p>为了解决 Google Fonts API 不稳定的问题，NexT 在 5.0.1 中引入此特性。 通过此特性，你可以指定所使用的字体库外链地址；与此同时，NexT 开放了 5 个特定范围的字体设定，他们是：
<em> 全局字体：定义的字体将在全站范围使用
</em> 标题字体：文章内标题的字体（h1, h2, h3, h4, h5, h6）
<em> 文章字体：文章所使用的字体
</em> Logo字体：Logo 所使用的字体
* 代码字体： 代码块所使用的字体</p>
<p>注意，各项所指定的字体将作为首选字体，当他们不可用时会自动 Fallback 到 NexT 设定的基础字体组：
非代码类字体：Fallback 到 “PingFang SC”, “Microsoft YaHei”, sans-serif
代码类字体： Fallback 到 consolas, Menlo, “PingFang SC”, “Microsoft YaHei”, monospace
另外，每一项都有一个额外的 external 属性，此属性用来控制是否使用外链字体库。 开放此属性方便你设定那些已经安装在系统中的字体，减少不必要的请求（请求大小）。
```css
font:
  enable: true</p>
<h1 id="外链字体库地址例如-fontsgoogleapiscom-默认值"><a href="#外链字体库地址例如-fontsgoogleapiscom-默认值" class="header-anchor"></a>11. <a href="#u5916_u94FE_u5B57_u4F53_u5E93_u5730_u5740_uFF0C_u4F8B_u5982_//fonts-googleapis-com__28_u9ED8_u8BA4_u503C_29" class="headerlink" title="外链字体库地址，例如 //fonts.googleapis.com (默认值)"></a>外链字体库地址，例如 //fonts.googleapis.com (默认值)</h1><p>  host: //fonts.googleapis.com</p>
<h1 id="全局字体应用在-body-元素上"><a href="#全局字体应用在-body-元素上" class="header-anchor"></a>12. <a href="#u5168_u5C40_u5B57_u4F53_uFF0C_u5E94_u7528_u5728_body__u5143_u7D20_u4E0A" class="headerlink" title="全局字体，应用在 body 元素上"></a>全局字体，应用在 body 元素上</h1><p>  global:
    external: true
    family: Lato</p>
<h1 id="标题字体-h1-h2-h3-h4-h5-h6"><a href="#标题字体-h1-h2-h3-h4-h5-h6" class="header-anchor"></a>13. <a href="#u6807_u9898_u5B57_u4F53__28h1_2C_h2_2C_h3_2C_h4_2C_h5_2C_h6_29" class="headerlink" title="标题字体 (h1, h2, h3, h4, h5, h6)"></a>标题字体 (h1, h2, h3, h4, h5, h6)</h1><p>  headings:
    external: true
    family: Playball
    size: 30</p>
<h1 id="文章字体"><a href="#文章字体" class="header-anchor"></a>14. <a href="#u6587_u7AE0_u5B57_u4F53" class="headerlink" title="文章字体"></a>文章字体</h1><p>  posts:
    external: true
    family:</p>
<h1 id="logo-字体"><a href="#logo-字体" class="header-anchor"></a>15. <a href="#Logo__u5B57_u4F53" class="headerlink" title="Logo 字体"></a>Logo 字体</h1><p>  logo:
    external: true
    family: Playball
    size: 40</p>
<h1 id="代码字体应用于-code-以及代码块"><a href="#代码字体应用于-code-以及代码块" class="header-anchor"></a>16. <a href="#u4EE3_u7801_u5B57_u4F53_uFF0C_u5E94_u7528_u4E8E_code__u4EE5_u53CA_u4EE3_u7801_u5757" class="headerlink" title="代码字体，应用于 code 以及代码块"></a>代码字体，应用于 code 以及代码块</h1><p>  codes:
    external: true
    family: Droid Sans Mono
    size: 25
```</p>
<h2 id="设置菜单"><a href="#设置菜单" class="header-anchor"></a>16.1. <a href="#u8BBE_u7F6E_u83DC_u5355" class="headerlink" title="设置菜单"></a>设置菜单</h2><p>菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 <a href="http://fontawesome.io/" target="_blank" rel="external">Font Awesome</a> 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景。参考<a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="external">官方设置菜单配置</a>
如添加一个新的页面“链接”：
<code>shell
hexo new page Links</code>
即在<code>hexo/source/</code>目录下新建了<code>Links</code>目录，目录中包含<code>index.md</code>文件，文件内容：</p>
<h2 id="css"><a href="#css" class="header-anchor"></a>16.2. <a href="#60_60_60css" class="headerlink" title="```css"></a>```css</h2><p>title: Links</p>
<h2 id="date-2017-07-20-103438"><a href="#date-2017-07-20-103438" class="header-anchor"></a>16.3. <a href="#date_3A_2017-07-20_10_3A34_3A38" class="headerlink" title="date: 2017-07-20 10:34:38"></a>date: 2017-07-20 10:34:38</h2><p>```</p>
<p>然后再NexT主题配置文件中的menu项和menu_ico项中加入 Links</p>
<p><code>css
menu:
  home: /
  categories: /categories/
  archives: /archives/
  tags: /tags/
  about: /about/
  links: /Links/ # note: links尝试用过Links: /Links发现会有问题——即使hexo g产生的/hexo/public目录中确实有/links，但是在推送到VPS的时候莫名其妙变成/Links，造成无法访问。</code>
```css
menu_icons:
  enable: true</p>
<h1 id="keymapstomenuitemkey-nameoftheiconfromfontawesome"><a href="#keymapstomenuitemkey-nameoftheiconfromfontawesome" class="header-anchor"></a>17. <a href="#KeyMapsToMenuItemKey_3A_NameOfTheIconFromFontAwesome" class="headerlink" title="KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome"></a>KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome</h1><p>  home: home
  about: user
  categories: th
  schedule: calendar
  tags: heart
  archives: archive
  links: heart
<code>最后要修改`/themes/next/languages/`中对应的语言文件`zh-Hans.yml`的中links项</code>css
menu:
  home: 首页
  archives: 归档
  categories: 分类
  tags: 标签
  about: 关于
  search: 搜索
  schedule: 日程表
  sitemap: 站点地图
  commonweal: 公益404
  links: 链接
```</p>
<h2 id="添加并美化本地搜索"><a href="#添加并美化本地搜索" class="header-anchor"></a>17.1. <a href="#u6DFB_u52A0_u5E76_u7F8E_u5316_u672C_u5730_u641C_u7D22" class="headerlink" title="添加并美化本地搜索"></a>添加并美化本地搜索</h2><p>NexT 主题内置了本地站内搜索，很方便添加。
1. 首先安装<code>hexo-generator-search</code>插件，用于生成博客索引数据
在站点的根目录下执行以下命令进行安装：
<code>sh
npm install hexo-generator-search --save</code>
2. 编辑 站点配置文件<code>_config.yml</code>，新增以下内容到任意位置：</p>
<p><code>css
search:
  path: search.xml
  field: post</code>
3. 编辑NexT主题配置文件<code>_config.yml</code>，解注释local search:
```css</p>
<h1 id="local-search"><a href="#local-search" class="header-anchor"></a>18. <a href="#Local_search" class="headerlink" title="Local search"></a>Local search</h1><p>local_search:
  enable: true</p>
<h1 id="if-auto-trigger-search-by-changing-input"><a href="#if-auto-trigger-search-by-changing-input" class="header-anchor"></a>19. <a href="#if_auto_2C_trigger_search_by_changing_input" class="headerlink" title="if auto, trigger search by changing input"></a>if auto, trigger search by changing input</h1><h1 id="if-manual-trigger-search-by-pressing-enter-key-or-search-button"><a href="#if-manual-trigger-search-by-pressing-enter-key-or-search-button" class="header-anchor"></a>20. <a href="#if_manual_2C_trigger_search_by_pressing_enter_key_or_search_button" class="headerlink" title="if manual, trigger search by pressing enter key or search button"></a>if manual, trigger search by pressing enter key or search button</h1><p>  path: search.xml
  fielf: post
  format: html
  limit: 10000
  trigger: auto</p>
<h1 id="注意把trigger-auto打开可以在输入的同时即时显示搜索结果"><a href="#注意把trigger-auto打开可以在输入的同时即时显示搜索结果" class="header-anchor"></a>21. <a href="#u6CE8_u610F_u628Atrigger_3A_auto_u6253_u5F00_uFF0C_u53EF_u4EE5_u5728_u8F93_u5165_u7684_u540C_u65F6_u5373_u65F6_u663E_u793A_u641C_u7D22_u7ED3_u679C" class="headerlink" title="注意把trigger: auto打开，可以在输入的同时即时显示搜索结果"></a>注意把trigger: auto打开，可以在输入的同时即时显示搜索结果</h1><h1 id="show-top-n-results-per-article-show-all-results-by-setting-to-1"><a href="#show-top-n-results-per-article-show-all-results-by-setting-to-1" class="header-anchor"></a>22. <a href="#show_top_n_results_per_article_2C_show_all_results_by_setting_to_-1" class="headerlink" title="show top n results per article, show all results by setting to -1"></a>show top n results per article, show all results by setting to -1</h1><h1 id="top_n_per_article-1"><a href="#top_n_per_article-1" class="header-anchor"></a>23. <a href="#top_n_per_article_3A_1" class="headerlink" title="top_n_per_article: 1"></a>top_n_per_article: 1</h1><p>```</p>
<h2 id="侧边栏头像修饰"><a href="#侧边栏头像修饰" class="header-anchor"></a>23.1. <a href="#u4FA7_u8FB9_u680F_u5934_u50CF_u4FEE_u9970" class="headerlink" title="侧边栏头像修饰"></a>侧边栏头像修饰</h2><p>把侧边栏头像变成圆形，并且鼠标停留在上面发生旋转效果，参考<a href="odepub.cn/2016/03/20/Hexo-blog-theme-switching-from-Jacman-to-NexT-Mist/">这里</a>，具体修改文件的位置是<code>hexo\themes\next\source\css\_common\components\sidebar\sidebar-author.styl</code>中的内容如下:
<code>css
.site-author-image {
  display: block;
  margin: 0 auto;
  max-width: 96px;
  height: auto;
  border: 2px solid #333;
  padding: 2px;
  /* start*/
  border-radius: 50%
  webkit-transition: 1.4s all;
  moz-transition: 1.4s all;
  ms-transition: 1.4s all;
  transition: 1.4s all;
  /* end */
}
/* start */
.site-author-image:hover {
  background-color: #55DAE1;
  webkit-transform: rotate(360deg) scale(1.1);
  moz-transform: rotate(360deg) scale(1.1);
  ms-transform: rotate(360deg) scale(1.1);
  transform: rotate(360deg) scale(1.1);
}
/* end */</code></p>
<h2 id="cloudinary-在线图片服务"><a href="#cloudinary-在线图片服务" class="header-anchor"></a>23.2. <a href="#Cloudinary__u5728_u7EBF_u56FE_u7247_u670D_u52A1" class="headerlink" title="Cloudinary 在线图片服务"></a>Cloudinary 在线图片服务</h2><p>除了在本地存储图片，还可以将图片上传到一些免费的CDN服务中。比如Cloudinary提供的图片CDN服务，在Cloudinary中上传图片后，会生成对应的url地址，将地址直接拿来引用即可。
在<a href="https://cloudinary.com" target="_blank" rel="external">Cloudinary</a>申请账号，上传图片(注意把upload选项中的unsigned signature选上)</p>
<h2 id="设置文章置顶"><a href="#设置文章置顶" class="header-anchor"></a>23.3. <a href="#u8BBE_u7F6E_u6587_u7AE0_u7F6E_u9876" class="headerlink" title="设置文章置顶"></a>设置文章置顶</h2><blockquote>
<p>note: 参考<a href="http://www.netcan666.com/2015/11/22/%E8%A7%A3%E5%86%B3Hexo%E7%BD%AE%E9%A1%B6%E9%97%AE%E9%A2%98/" target="_blank" rel="external">解决文章置顶</a></p>
</blockquote>
<ol>
<li><p>安装 hexo-generator-index
<code>sh
npm i --save hexo-generator-index</code></p>
</li>
<li><p>将如下的代码加入<code>node_modules/hexo-generator-index/lib/generator.js</code></p>
</li>
</ol>
<p><code>js
posts.data = posts.data.sort(function(a, b) {
    if(a.top &amp;&amp; b.top) { // 两篇文章top都有定义
        if(a.top == b.top) return b.date - a.date; // 若top值一样则按照文章日期降序排
        else return b.top - a.top; // 否则按照top值降序排
    }
    else if(a.top &amp;&amp; !b.top) { // 以下是只有一篇文章top有定义，那么将有top的排在前面（这里用异或操作居然不行233）
        return -1;
    }
    else if(!a.top &amp;&amp; b.top) {
        return 1;
    }
    else return b.date - a.date; // 都没定义按照文章日期降序排
});</code>
最终的 <code>node_modules/hexo-generator-index/lib/generator.js</code> 代码:</p>
<p><code>java
&#39;use strict&#39;;
var pagination = require(&#39;hexo-pagination&#39;);
module.exports = function(locals) {
    var config = this.config;
    var posts = locals.posts.sort(config.index_generator.order_by);
    var paginationDir = config.pagination_dir || &#39;page&#39;;
    posts.data = posts.data.sort(function(a, b) {
        if(a.top &amp;&amp; b.top) { // 两篇文章top都有定义
            if(a.top == b.top) return b.date - a.date; // 若top值一样则按照文章日期降序排
            else return b.top - a.top; // 否则按照top值降序排
        }
        else if(a.top &amp;&amp; !b.top) { // 以下是只有一篇文章top有定义，那么将有top的排在前面（这里用异或操作居然不行233）
            return -1;
        }
        else if(!a.top &amp;&amp; b.top) {
            return 1;
        }
        else return b.date - a.date; // 都没定义按照文章日期降序排
    });
    return pagination(&#39;&#39;, posts, {
        perPage: config.index_generator.per_page,
        layout: [&#39;index&#39;, &#39;archive&#39;],
        format: paginationDir + &#39;/%d/&#39;,
        data: {
          __index: true
        }
    });
};</code></p>
<p>在文章 <code>Front-matter</code> 中添加 <code>top</code> 值，数值越大文章越靠前，如：
<code>css
title: Hexo
date: 2017-07-21
tags: vps
categories: vps
top: 3</code></p>
<h2 id="next主题宽度调整"><a href="#next主题宽度调整" class="header-anchor"></a>23.4. <a href="#next_u4E3B_u9898_u5BBD_u5EA6_u8C03_u6574" class="headerlink" title="next主题宽度调整"></a>next主题宽度调整</h2><p>编辑 <code>themes/next/source/css/_variables/custom.styl</code> 文件，新增变量：
<code>css
// 修改成你期望的宽度
$content-desktop = 700px
// 当视窗超过 1600px 后的宽度
$content-desktop-large = 900px</code>
以上方法不适用与next.Picses scheme
<code>Pisces Scheme</code> 编辑<code>themes/next/source/css/_schemes/Picses/_layout.styl</code>文件，更改以下 css 选项定义值：
<code>css
.header{ width: 1150px; }
.container .main-inner { width: 1150px; }
.content-wrap { width: calc(100% - 260px); }</code></p>
<h2 id="设置disqus"><a href="#设置disqus" class="header-anchor"></a>23.5. <a href="#u8BBE_u7F6Edisqus" class="headerlink" title="设置disqus"></a>设置disqus</h2><blockquote>
<p>note: “多说”评论功能应用广泛，但是据其公司的<a href="http://dev.duoshuo.com/threads/58d1169ae293b89a20c57241" target="_blank" rel="external">声明</a>，多说网已经关闭。</p>
</blockquote>
<p>hexo已经内置了对disqus的支持，配置也很简单
1. 首先注册disques账号
  https://disqus.com 获取shortname
2. next主题内置了对disqus的支持，在next主题的_config_xml中搜索disqus，并做如下配置：
  ```css</p>
<h1 id="disqus"><a href="#disqus" class="header-anchor"></a>24. <a href="#disqus" class="headerlink" title="disqus"></a>disqus</h1><p>  disqus:
    enable: True
    shortname: jiaxm-me
    count: true
  ```</p>
<h2 id="给github添加readme"><a href="#给github添加readme" class="header-anchor"></a>24.1. <a href="#u7ED9github_u6DFB_u52A0README" class="headerlink" title="给github添加README"></a>给github添加README</h2><p>hexo会把md文件都解析成html，但是github的readme只支持MD格式，最简单的方法是让hexo不对README.md做转换。
站点配置文件_config_xml中的<code>skip_render:</code>改为<code>skip_render: README.md</code>
note: README.md放在 hexo/source/目录中即可</p>
<h2 id="markdown里-table-的语法"><a href="#markdown里-table-的语法" class="header-anchor"></a>24.2. <a href="#MarkDown_u91CC_table__u7684_u8BED_u6CD5" class="headerlink" title="MarkDown里 table 的语法"></a>MarkDown里 table 的语法</h2><p>MD的写法
<code>python
| I | am | table |
|:-----|:---:|----------:|
|文本内容| **`是`** |table|
|文本内容| **`是`** |table|
|文本内容| **`是`** |table|</code></p>
<ol>
<li>表格与上面的文本内容之间<strong>空一行</strong>。否则解析不出来</li>
<li>最上面一行是表格第一列的值。第二行的冒号位置决定表格内文本的对齐方式。有水平居中、水平靠左对齐、水平靠右对齐三种</li>
<li>每列的宽度是根据对应列里最长的文本来决定的</li>
</ol>
<p>输出结果：</p>
<p>| 我 | 是 | 展示表格 |
|:—–|:—:|———-:|
|文本内容| <strong><code>是</code></strong> |table|
|文本内容| <strong><code>是</code></strong> |table|
|文本内容| <strong><code>是</code></strong> |table|</p>
<h2 id="去除b2t-sidebar"><a href="#去除b2t-sidebar" class="header-anchor"></a>24.3. <a href="#u53BB_u9664b2t_sidebar" class="headerlink" title="去除b2t sidebar"></a>去除b2t sidebar</h2><p>找到<code>Hexo/themes/next/layout/_macro/sidebar.swig</code>文件，去掉其中关于b2t的部分：
<code>css
</code></p>
<h1 id="主题配置参考"><a href="#主题配置参考" class="header-anchor"></a>25. <a href="#u4E3B_u9898_u914D_u7F6E_u53C2_u8003" class="headerlink" title="主题配置参考"></a>主题配置参考</h1><ol>
<li><a href="http://chitanda.me/2015/06/11/tips-for-setup-hexo/" target="_blank" rel="external">markdown table</a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.jiaxm.me/2017-07-day/Markdown Writing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jxm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-07-day/Markdown Writing/" itemprop="url">Markdown Writing</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-24T21:21:00+08:00">
                2017-07-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/markdown/" itemprop="url" rel="index">
                    <span itemprop="name">markdown</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017-07-day/Markdown Writing/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017-07-day/Markdown Writing/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Markdown语法测试
&lt;!--more--&gt;</p>
<h1 id="任务列表"><a href="#任务列表" class="header-anchor"></a>1. <a href="#u4EFB_u52A1_u5217_u8868" class="headerlink" title="任务列表"></a>任务列表</h1><p>在任务项目前面加[]。用[x]表示此项已完成。
<code>- [x] Finish my changes
- [ ] Push my commits to GitHub
- [ ] Open a pull request</code></p>
<ul>
<li>[x] Finish my changes</li>
<li>[ ] Push my commits to GitHub</li>
<li>[ ] Open a pull request</li>
</ul>
<p>注意如果项目内容以（）开始要对（加转义字符\
<code>- [ ] \(Optional) Open a followup issue</code></p>
<ul>
<li>[ ] (Optional) Open a followup issue</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.jiaxm.me/2017-07-day/VPS Configuraton/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jxm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-07-day/VPS Configuraton/" itemprop="url">VPS Configuration</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-04T12:00:04+08:00">
                2017-07-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/VPS/" itemprop="url" rel="index">
                    <span itemprop="name">VPS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017-07-day/VPS Configuraton/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017-07-day/VPS Configuraton/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>VPS（Virtual Private Server 虚拟专用服务器）技术，将一台服务器分割成多个虚拟专享服务器的优质服务。简单的说，VPS就是一台拥有公网IP的服务器总结一下VPS搭建的过程，从域名的购买到VPS的设置
&lt;!--more--&gt;</p>
<h1 id="vps的配置"><a href="#vps的配置" class="header-anchor"></a>1. <a href="#VPS_u7684_u914D_u7F6E" class="headerlink" title="VPS的配置"></a>VPS的配置</h1><h2 id="vps的购买-tbd"><a href="#vps的购买-tbd" class="header-anchor"></a>1.1. <a href="#VPS_u7684_u8D2D_u4E70_TBD" class="headerlink" title="VPS的购买 TBD"></a>VPS的购买 TBD</h2><h2 id="vps在ubuntu-1704下的软件配置"><a href="#vps在ubuntu-1704下的软件配置" class="header-anchor"></a>1.2. <a href="#VPS_u5728ubuntu_17-04_u4E0B_u7684_u8F6F_u4EF6_u914D_u7F6E" class="headerlink" title="VPS在ubuntu 17.04下的软件配置"></a>VPS在ubuntu 17.04下的软件配置</h2><p><code>bash
$ apt-get update &amp;&amp; apt-get upgrade
$ apt-get install git git-core
$ curl -sL https://deb.nodesource.com/setup_6.x | sudo -E bash -
$ apt-get install -y nodejs
$ npm install hexo-cli hexo-server -g
$ apt-get install nginx</code></p>
<h1 id="第三方服务"><a href="#第三方服务" class="header-anchor"></a>2. <a href="#u7B2C_u4E09_u65B9_u670D_u52A1" class="headerlink" title="第三方服务"></a>第三方服务</h1><h2 id="腾讯企业邮箱"><a href="#腾讯企业邮箱" class="header-anchor"></a>2.1. <a href="#u817E_u8BAF_u4F01_u4E1A_u90AE_u7BB1" class="headerlink" title="腾讯企业邮箱"></a>腾讯企业邮箱</h2><ol>
<li>购买域名</li>
<li>注册腾讯企业邮箱</li>
<li>在域名购买处填写MX记录 （注册腾讯企业邮箱过程中会有提示）</li>
<li>SPF 防止发出的邮件被识别为垃圾邮件。SPF是通过域名的TXT记录来进行设置的。
为了提升域名邮箱发送外域（@qq.com以外的邮箱）邮件的成功率，可以给自己的域名设置一条TXT记录来避免这种情况。 TXT记录值为：<code>v=spf1 include:spf.mail.qq.com ~all</code></li>
</ol>
<h2 id="shadowsocks的搭建"><a href="#shadowsocks的搭建" class="header-anchor"></a>2.2. <a href="#Shadowsocks_u7684_u642D_u5EFA" class="headerlink" title="Shadowsocks的搭建"></a>Shadowsocks的搭建</h2><p>见<a href="http://jiaxm.me/2017-07-day/Shadowsocks%20%E6%90%AD%E5%BB%BA/#more" target="_blank" rel="external">站内文章-Shadowsocks搭建</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.jiaxm.me/2017-07-day/NumPy Learn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jxm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-07-day/NumPy Learn/" itemprop="url">Learn Numpy The Hard Way</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-19T09:55:00+08:00">
                2017-07-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017-07-day/NumPy Learn/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017-07-day/NumPy Learn/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>NumPy, which stands for Numerical Python, is a library consisting of multidimensional array objects and a collection of routines for processing those arrays. Using NumPy, mathematical and logical operations on arrays can be performed
一些参考资料：
<a href="http://scipy-lectures.github.io/intro/numpy/index.html" target="_blank" rel="external">Basics of numpy</a>
<a href="http://scipy-lectures.github.io/intro/numpy/exercises.html" target="_blank" rel="external">Some numpy exercises</a>
<a href="http://scipy-lectures.github.io/advanced/advanced_numpy/" target="_blank" rel="external">Advanced numpy</a>
<a href="http://docs.scipy.org/doc/numpy/reference/" target="_blank" rel="external">Numpy reference</a></p>
<p>&lt;!--more--&gt;
</p>
<h1 id="numpy的前世今生"><a href="#numpy的前世今生" class="header-anchor"></a>1. <a href="#Numpy_u7684_u524D_u4E16_u4ECA_u751F" class="headerlink" title="Numpy的前世今生"></a>Numpy的前世今生</h1><p><strong>Numeric</strong>, the ancestor of NumPy, was developed by Jim Hugunin. Another package Numarray was also developed, having some additional functionalities. In 2005, Travis Oliphant created NumPy package by incorporating the features of Numarray into Numeric package. There are many contributors to this open source project.</p>
<h1 id="numpy数值类型"><a href="#numpy数值类型" class="header-anchor"></a>2. <a href="#Numpy_u6570_u503C_u7C7B_u578B" class="headerlink" title="Numpy数值类型"></a>Numpy数值类型</h1><p>NumPy中的基本数据类型</p>
<p>|名称 |    描述 |
|:—-|:—-|
|bool| 用一个字节存储的布尔类型（True或False）|
|inti|    由所在平台决定其大小的整数（一般为int32或int64）|
|int8|    一个字节大小，-128 至 127|
|int16|    整数，-32768 至 32767|
|int32|    整数，-2 <strong> 31 至 2 </strong> 32 -1
|int64|    整数，-2 <strong> 63 至 2 </strong> 63 - 1
|uint8|    无符号整数，0 至 255
|uint16|    无符号整数，0 至 65535
|uint32|    无符号整数，0 至 2 <strong> 32 - 1
|uint64|    无符号整数，0 至 2 </strong> 64 - 1
|float16|    半精度浮点数：16位，正负号1位，指数5位，精度10位
|float32|    单精度浮点数：32位，正负号1位，指数8位，精度23位
|float64或float|    双精度浮点数：64位，正负号1位，指数11位，精度52位
|complex64|    复数，分别用两个32位浮点数表示实部和虚部
|complex128或complex|    复数，分别用两个64位浮点数表示实部和虚部</p>
<h1 id="numpy数组的初始化"><a href="#numpy数组的初始化" class="header-anchor"></a>3. <a href="#Numpy_u6570_u7EC4_u7684_u521D_u59CB_u5316" class="headerlink" title="Numpy数组的初始化"></a>Numpy数组的初始化</h1><p>Numpy的主要数据类型是ndarray，即多维数组。它有以下几个属性：
ndarray.ndim：数组的维数
ndarray.shape：数组每一维的大小
ndarray.size：数组中全部元素的数量
ndarray.dtype：数组中元素的类型（numpy.int32, numpy.int16, and numpy.float64等）
ndarray.itemsize：每个元素占几个字节</p>
<p>```python
import numpy as np</p>
<p>np.arange(24).reshape(3,8) # np.arange初始化数组并reshape</p>
<h1 id="生成数组赋特殊值"><a href="#生成数组赋特殊值" class="header-anchor"></a>4. <a href="#u751F_u6210_u6570_u7EC4_u8D4B_u7279_u6B8A_u503C_uFF1A" class="headerlink" title="生成数组赋特殊值："></a>生成数组赋特殊值：</h1><p>np.zeros(24)
np.ones(24)</p>
<h1 id="由于numpy可以按index取值所以zerosones方法可以用来创建bool数组用于取值"><a href="#由于numpy可以按index取值所以zerosones方法可以用来创建bool数组用于取值" class="header-anchor"></a>5. <a href="#u7531_u4E8Enumpy_u53EF_u4EE5_u6309index_u53D6_u503C_uFF0C_u6240_u4EE5zeros/ones_u65B9_u6CD5_u53EF_u4EE5_u7528_u6765_u521B_u5EFAbool_u6570_u7EC4_u7528_u4E8E_u53D6_u503C" class="headerlink" title="由于numpy可以按index取值，所以zeros/ones方法可以用来创建bool数组用于取值"></a>由于numpy可以按index取值，所以zeros/ones方法可以用来创建bool数组用于取值</h1><blockquote>
<blockquote>
<blockquote>
<p>np.ones(24, dtype=bool)
array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True], dtype=bool)</p>
<p>np.empty(24)  # 随机数，取决于内存情况
array([  6.89818397e-310,   6.89818397e-310,   6.89817518e-310,
         6.89817518e-310,   6.89817384e-310,   6.89817852e-310,
         6.89818486e-310,   6.89818483e-310,   6.89817852e-310,
         6.89817384e-310,   6.89818483e-310,   6.89817384e-310,
         6.89818486e-310,   6.89818486e-310,   6.89818483e-310,
         6.89817518e-310,   6.89818486e-310,   6.89818484e-310,
         6.89817518e-310,   6.89818488e-310,   6.89817518e-310,
         6.89818486e-310,   6.89818488e-310,   6.89818484e-310])
‘np.arange() （最小值，最大值，步长）（左闭右开） ‘
‘np.linspace（最小值，最大值，元素数量）’
np.linspace(0, 2*np.pi, 20)
array([ 0.        ,  0.33069396,  0.66138793,  0.99208189,  1.32277585,
        1.65346982,  1.98416378,  2.31485774,  2.64555171,  2.97624567,
        3.30693964,  3.6376336 ,  3.96832756,  4.29902153,  4.62971549,
        4.96040945,  5.29110342,  5.62179738,  5.95249134,  6.28318531])
```</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="numpy-数组的寻址索引和遍历"><a href="#numpy-数组的寻址索引和遍历" class="header-anchor"></a>6. <a href="#Numpy__u6570_u7EC4_u7684_u5BFB_u5740_uFF0C_u7D22_u5F15_u548C_u904D_u5386" class="headerlink" title="Numpy 数组的寻址，索引和遍历"></a>Numpy 数组的寻址，索引和遍历</h1><p>多维数组的访问通过给每一维指定一个索引，顺序是先高维再低维：
```python
def f(x, y):
    return 10*x + y</p>
<blockquote>
<blockquote>
<blockquote>
<p>np.fromfunction(f, (5,4), dtype=np.int)
array([[ 0,  1,  2,  3],
       [10, 11, 12, 13],
       [20, 21, 22, 23],
       [30, 31, 32, 33],
       [40, 41, 42, 43]])
b[1:3, :]
array([[10, 11, 12, 13],
              [20, 21, 22, 23]])
<code>…符号表示将所有未指定索引的维度均赋为：，：表示索引该维度范围所有元素</code>python
c =  np.arange(24).reshape(2,3,4)
array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11]],</p>
</blockquote>
</blockquote>
</blockquote>
<pre><code>   [[12, 13, 14, 15],
    [16, 17, 18, 19],
    [20, 21, 22, 23]]])
</code></pre><blockquote>
<blockquote>
<blockquote>
<p>c[1,…]
array([[12, 13, 14, 15],
       [16, 17, 18, 19],
       [20, 21, 22, 23]])
<code>遍历数组的方法可以用循环/迭代器等。如果需要flatten数组然后访问，可以用c.flat做一个迭代器，也可以用c.flatten（）函数将数组先一维展开。</code>python
for i in c.flat:
        print(i)</p>
<h1 id="即可打印所有元素"><a href="#即可打印所有元素" class="header-anchor"></a>7. <a href="#u5373_u53EF_u6253_u5370_u6240_u6709_u5143_u7D20" class="headerlink" title="即可打印所有元素"></a>即可打印所有元素</h1><p>c.flatten()
array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23])
```</p>
</blockquote>
</blockquote>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.jiaxm.me/2017-07-day/Shadowsocks_Configuration/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jxm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-07-day/Shadowsocks_Configuration/" itemprop="url">Shadowsocks 的搭建</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-14T00:00:00+08:00">
                2017-07-14
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017-07-day/Shadowsocks_Configuration/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017-07-day/Shadowsocks_Configuration/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>对于做科研、写代码的同学来说，翻<a href="https://zh.wikipedia.org/wiki/%E9%98%B2%E7%81%AB%E9%95%BF%E5%9F%8E" target="_blank" rel="external">GFW</a>是必不可少的，对于专业的资料来说，google/sholar搜索的丰富程度可以秒某度的。梯子有很多种，例如改hosts、vpn(SoftEther)、浏览器翻墙的插件(谷歌上网助手)、自由门、GoAgent、cow、Lantern等等。今天我们来介绍一下在国外<a href="https://en.wikipedia.org/wiki/Virtual_private_server" target="_blank" rel="external">VPS</a>(Virtual private server)的搭建，不只是可以用来上google，scholar等，可以说相当于拥有了国外的网络环境，没有限制的浏览国外网站。
&lt;!--more--&gt;</p>
<h1 id="shadowsocks-简介"><a href="#shadowsocks-简介" class="header-anchor"></a>1. <a href="#Shadowsocks__u7B80_u4ECB" class="headerlink" title="Shadowsocks 简介"></a>Shadowsocks 简介</h1><p>维基百科搬运：</p>
<blockquote>
<blockquote>
<p>Shadowsocks (以下简称“ss”) 是一种基于Sock5代理方式的网络资料加密传输工具，分为服务器端和客户端。使用之前，需先将服务器端部署到服务器上面，然后通过客户端连接并建立本地代理。
ss的运行原理与其他代理工具基本相同，使用特定的中转服务器完成数据传输。在服务器端部署完成后，用户需要按照指定的密码、加密方式和端口使用客户端软件与其连接。在成功连接到服务器后，客户端会在用户的电脑上构建一个本地Socks5代理。浏览网络时，网络流量会被分到本地socks5代理，客户端将其加密之后发送到服务器，服务器以同样的加密方式将流量回传给客户端，以此实现代理上网。ss的创建者<a href="http://github.com/clowwindy" target="_blank" rel="external">clowwindy</a>是中国人，15年8月22日受到一些外部压力，宣布停止维护此计划（项目）并移除其个人页面所存储的源代码，</p>
</blockquote>
</blockquote>
<p>详细News请移步<a href="https://zh.wikipedia.org/wiki/Shadowsocks" target="_blank" rel="external">维基百科</a>。</p>
<h1 id="ss-搭建"><a href="#ss-搭建" class="header-anchor"></a>2. <a href="#ss__u642D_u5EFA" class="headerlink" title="ss 搭建"></a>ss 搭建</h1><p>详细的搭建步骤有点琐碎，故分列几条。
1. 安装 Shadowsocks
2. server端配置
4. Windows客户端配置
5. Android客户端配置</p>
<h2 id="安装-ss"><a href="#安装-ss" class="header-anchor"></a>2.1. <a href="#u5B89_u88C5_ss" class="headerlink" title="安装 ss"></a>安装 ss</h2><p>以Ubuntu 17.04为例。
<code>bash
sudo apt-get update # 升级下
sudo apt-get install python-pip
sudo pip install shadowsocks # 安装ss
sudo apt–get install python–m2crypto # 用以支持加密方式</code></p>
<h2 id="server端配置-ss"><a href="#server端配置-ss" class="header-anchor"></a>2.2. <a href="#server_u7AEF_u914D_u7F6E_ss" class="headerlink" title="server端配置 ss"></a>server端配置 ss</h2><h3 id="即时启动"><a href="#即时启动" class="header-anchor"></a>2.2.1. <a href="#u5373_u65F6_u542F_u52A8_uFF1A" class="headerlink" title="即时启动："></a>即时启动：</h3><p><code>sudo ssserver -p 8388 -k password -m rc4-md5 -d start</code></p>
<h3 id="使用配置文件启动"><a href="#使用配置文件启动" class="header-anchor"></a>2.2.2. <a href="#u4F7F_u7528_u914D_u7F6E_u6587_u4EF6_u542F_u52A8_uFF1A" class="headerlink" title="使用配置文件启动："></a>使用配置文件启动：</h3><p>编辑/etc/shadowsocks/config.json文件（如果没有可以创建此文件）
<code>json
{
&quot;server&quot;:&quot;my_server_ip&quot;,
&quot;server_port&quot;:8388,
&quot;local_address&quot;: &quot;127.0.0.1&quot;,
&quot;local_port&quot;:1080,
&quot;password&quot;:&quot;mypassword&quot;,
&quot;timeout&quot;:300,
&quot;method&quot;:&quot;rc4-md5&quot;
}</code>
字段含义：</p>
<p>字段 | 含义<br>———— | ————-
server | 服务器 IP (IPv4/IPv6)
server_port | 服务器端口
local_port | 本地端端口
password | 密码
timeout | 超时时间(s)
method | 加密方法， 可选“bf-cfb”, “aes-256-cfb”, “rc4-md5”,等</p>
<blockquote>
<p>加密方式推荐使用rc4-md5，因为 RC4 比 AES 速度快好几倍，如果用在路由器上会带来显著性能提升。旧的 RC4 加密之所以不安全是因为 Shadowsocks 在每个连接上重复使用 key，没有使用 IV。现在已经重新正确实现，可以放心使用。</p>
</blockquote>
<p>config.json文件创建完毕后，赋予755权限
<code>sudo chmod 755 /etc/shadowsocks/config.json</code>
使用配置文件，后台运行：
<code>sudo ssserver -c /etc/shadowsocks/config.json -d start</code></p>
<h3 id="开机启动"><a href="#开机启动" class="header-anchor"></a>2.2.3. <a href="#u5F00_u673A_u542F_u52A8" class="headerlink" title="开机启动"></a>开机启动</h3><p>上述两种方法都是在机器没有重启的情况下用的，每次重启后都手动去开启ss服务有点麻烦，所以设置开机启动可以省点事。
创建 /etc/init.d/shadowsocks 文件 <code>sudo vim /etc/init.d/shadowsocks</code>
添加以下内容：
```bash</p>
<h1 id="binsh"><a href="#binsh" class="header-anchor"></a>3.2. <a href="#21/bin/sh" class="headerlink" title="!/bin/sh"></a>!/bin/sh</h1><h3 id="begin-init-info"><a href="#begin-init-info" class="header-anchor"></a>3.2.1. <a href="#BEGIN_INIT_INFO" class="headerlink" title="BEGIN INIT INFO"></a>BEGIN INIT INFO</h3><h1 id="provides-shadowsocks"><a href="#provides-shadowsocks" class="header-anchor"></a>4.2. <a href="#Provides_3A_shadowsocks" class="headerlink" title="Provides:          shadowsocks"></a>Provides:          shadowsocks</h1><h1 id="required-start-remote_fs-syslog"><a href="#required-start-remote_fs-syslog" class="header-anchor"></a>5.2. <a href="#Required-Start_3A__24remote_fs__24syslog" class="headerlink" title="Required-Start:    $remote_fs $syslog"></a>Required-Start:    $remote_fs $syslog</h1><h1 id="required-stop-remote_fs-syslog"><a href="#required-stop-remote_fs-syslog" class="header-anchor"></a>6.2. <a href="#Required-Stop_3A__24remote_fs__24syslog" class="headerlink" title="Required-Stop:     $remote_fs $syslog"></a>Required-Stop:     $remote_fs $syslog</h1><h1 id="default-start-2-3-4-5"><a href="#default-start-2-3-4-5" class="header-anchor"></a>7.2. <a href="#Default-Start_3A_2_3_4_5" class="headerlink" title="Default-Start:     2 3 4 5"></a>Default-Start:     2 3 4 5</h1><h1 id="default-stop-0-1-6"><a href="#default-stop-0-1-6" class="header-anchor"></a>8.2. <a href="#Default-Stop_3A_0_1_6" class="headerlink" title="Default-Stop:      0 1 6"></a>Default-Stop:      0 1 6</h1><h1 id="short-description-start-shadowsocks"><a href="#short-description-start-shadowsocks" class="header-anchor"></a>9.2. <a href="#Short-Description_3A_start_shadowsocks" class="headerlink" title="Short-Description: start shadowsocks"></a>Short-Description: start shadowsocks</h1><h1 id="description-start-shadowsocks"><a href="#description-start-shadowsocks" class="header-anchor"></a>10.2. <a href="#Description_3A_start_shadowsocks" class="headerlink" title="Description:       start shadowsocks"></a>Description:       start shadowsocks</h1><h3 id="end-init-info"><a href="#end-init-info" class="header-anchor"></a>10.2.1. <a href="#END_INIT_INFO" class="headerlink" title="END INIT INFO"></a>END INIT INFO</h3><p>start(){
    ssserver -c /etc/shadowsocks/config.json -d start
}</p>
<p>stop(){
    ssserver -c /etc/shadowsocks/config.json -d stop
}</p>
<p>case “$1” in
start)
    start
    ;;
stop)
    stop
    ;;
reload)
     stop
     start
     ;;
*)
    echo “Usage: $0 {start|reload|stop}”
    exit 1
    ;;
esac
<code>``
增加这个文件的可执行权限</code>sudo chmod +x /etc/init.d/shadowsocks<code>在rc.d中新增</code>sudo update-rc.d shadowsocks defaults<code>，添加到开机启动中
以后就可以通过</code>sudo service shadowsocks {start|reload|stop}`来管理了。</p>
<h3 id="ss-速度优化"><a href="#ss-速度优化" class="header-anchor"></a>10.2.2. <a href="#ss__u901F_u5EA6_u4F18_u5316" class="headerlink" title="ss 速度优化"></a>ss 速度优化</h3><p>基于kvm架构vps的优化
这方面SS给出了非常详尽的优化指南，主要有：优化内核参数，开启TCP Fast Open
这里只给出优化内核参数/优化加密方式的方法。更多、更详细的策略方法请参考<a href="https://github.com/iMeiji/shadowsocks_install/wiki/shadowsocks-optimize" target="_blank" rel="external">shadowsocks optimize</a></p>
<h4 id="内核参数优化"><a href="#内核参数优化" class="header-anchor"></a>10.2.2.1. <a href="#u5185_u6838_u53C2_u6570_u4F18_u5316" class="headerlink" title="内核参数优化"></a>内核参数优化</h4><p>创建 /etc/sysctl.d/local.conf 并写入
```bash</p>
<h1 id="max-open-files"><a href="#max-open-files" class="header-anchor"></a>11.2.2. <a href="#max_open_files" class="headerlink" title="max open files"></a>max open files</h1><p>fs.file-max = 1024000</p>
<h1 id="max-read-buffer"><a href="#max-read-buffer" class="header-anchor"></a>12.2.2. <a href="#max_read_buffer" class="headerlink" title="max read buffer"></a>max read buffer</h1><p>net.core.rmem_max = 67108864</p>
<h1 id="max-write-buffer"><a href="#max-write-buffer" class="header-anchor"></a>13.2.2. <a href="#max_write_buffer" class="headerlink" title="max write buffer"></a>max write buffer</h1><p>net.core.wmem_max = 67108864</p>
<h1 id="default-read-buffer"><a href="#default-read-buffer" class="header-anchor"></a>14.2.2. <a href="#default_read_buffer" class="headerlink" title="default read buffer"></a>default read buffer</h1><p>net.core.rmem_default = 65536</p>
<h1 id="default-write-buffer"><a href="#default-write-buffer" class="header-anchor"></a>15.2.2. <a href="#default_write_buffer" class="headerlink" title="default write buffer"></a>default write buffer</h1><p>net.core.wmem_default = 65536</p>
<h1 id="max-processor-input-queue"><a href="#max-processor-input-queue" class="header-anchor"></a>16.2.2. <a href="#max_processor_input_queue" class="headerlink" title="max processor input queue"></a>max processor input queue</h1><p>net.core.netdev_max_backlog = 4096</p>
<h1 id="max-backlog"><a href="#max-backlog" class="header-anchor"></a>17.2.2. <a href="#max_backlog" class="headerlink" title="max backlog"></a>max backlog</h1><p>net.core.somaxconn = 4096</p>
<h1 id="resist-syn-flood-attacks"><a href="#resist-syn-flood-attacks" class="header-anchor"></a>18.2.2. <a href="#resist_SYN_flood_attacks" class="headerlink" title="resist SYN flood attacks"></a>resist SYN flood attacks</h1><p>net.ipv4.tcp_syncookies = 1</p>
<h1 id="reuse-timewait-sockets-when-safe"><a href="#reuse-timewait-sockets-when-safe" class="header-anchor"></a>19.2.2. <a href="#reuse_timewait_sockets_when_safe" class="headerlink" title="reuse timewait sockets when safe"></a>reuse timewait sockets when safe</h1><p>net.ipv4.tcp_tw_reuse = 1</p>
<h1 id="turn-off-fast-timewait-sockets-recycling"><a href="#turn-off-fast-timewait-sockets-recycling" class="header-anchor"></a>20.2.2. <a href="#turn_off_fast_timewait_sockets_recycling" class="headerlink" title="turn off fast timewait sockets recycling"></a>turn off fast timewait sockets recycling</h1><p>net.ipv4.tcp_tw_recycle = 0</p>
<h1 id="short-fin-timeout"><a href="#short-fin-timeout" class="header-anchor"></a>21.2.2. <a href="#short_FIN_timeout" class="headerlink" title="short FIN timeout"></a>short FIN timeout</h1><p>net.ipv4.tcp_fin_timeout = 30</p>
<h1 id="short-keepalive-time"><a href="#short-keepalive-time" class="header-anchor"></a>22.2.2. <a href="#short_keepalive_time" class="headerlink" title="short keepalive time"></a>short keepalive time</h1><p>net.ipv4.tcp_keepalive_time = 1200</p>
<h1 id="outbound-port-range"><a href="#outbound-port-range" class="header-anchor"></a>23.2.2. <a href="#outbound_port_range" class="headerlink" title="outbound port range"></a>outbound port range</h1><p>net.ipv4.ip_local_port_range = 10000 65000</p>
<h1 id="max-syn-backlog"><a href="#max-syn-backlog" class="header-anchor"></a>24.2.2. <a href="#max_SYN_backlog" class="headerlink" title="max SYN backlog"></a>max SYN backlog</h1><p>net.ipv4.tcp_max_syn_backlog = 4096</p>
<h1 id="max-timewait-sockets-held-by-system-simultaneously"><a href="#max-timewait-sockets-held-by-system-simultaneously" class="header-anchor"></a>25.2.2. <a href="#max_timewait_sockets_held_by_system_simultaneously" class="headerlink" title="max timewait sockets held by system simultaneously"></a>max timewait sockets held by system simultaneously</h1><p>net.ipv4.tcp_max_tw_buckets = 5000</p>
<h1 id="tcp-receive-buffer"><a href="#tcp-receive-buffer" class="header-anchor"></a>26.2.2. <a href="#TCP_receive_buffer" class="headerlink" title="TCP receive buffer"></a>TCP receive buffer</h1><p>net.ipv4.tcp_rmem = 4096 87380 67108864</p>
<h1 id="tcp-write-buffer"><a href="#tcp-write-buffer" class="header-anchor"></a>27.2.2. <a href="#TCP_write_buffer" class="headerlink" title="TCP write buffer"></a>TCP write buffer</h1><p>net.ipv4.tcp_wmem = 4096 65536 67108864</p>
<h1 id="turn-on-path-mtu-discovery"><a href="#turn-on-path-mtu-discovery" class="header-anchor"></a>28.2.2. <a href="#turn_on_path_MTU_discovery" class="headerlink" title="turn on path MTU discovery"></a>turn on path MTU discovery</h1><p>net.ipv4.tcp_mtu_probing = 1</p>
<h1 id="for-high-latency-network"><a href="#for-high-latency-network" class="header-anchor"></a>29.2.2. <a href="#for_high-latency_network" class="headerlink" title="for high-latency network"></a>for high-latency network</h1><p>net.ipv4.tcp_congestion_control = htcp</p>
<h1 id="forward-ipv4"><a href="#forward-ipv4" class="header-anchor"></a>30.2.2. <a href="#forward_ipv4" class="headerlink" title="forward ipv4"></a>forward ipv4</h1><p>net.ipv4.ip_forward = 1
<code>``
其中最后的</code>hybla<code>是为高延迟网络（如美国，欧洲）准备的算法，需要内核支持，测试内核是否支持，在终端输入：</code>sysctl net.ipv4.tcp_available_congestion_control<code>如果结果中有</code>hybla<code>，则证明你的内核已开启</code>hybla<code>，如果没有</code>hybla<code>，可以用命令</code>modprobe tcp_hybla`开启。</p>
<p>对于低延迟的网络（如日本，香港等），可以使用<code>htcp</code>，可以非常显著的提高速度，首先使用<code>modprobe tcp_htcp</code>开启，再将<code>net.ipv4.tcp_congestion_control = hybla改为net.ipv4.tcp_congestion_control = htcp</code>，建议EC2日本用户使用这个算法。</p>
<p>使配置生效：sysctl –system
note: 经过手机Andoid客户端测试, 速度确实有提升（之前手机端速度感觉已经很快了！），YouTube上1080p的高清视频一点不卡，甚至于还没有缓冲到的时间点直接点击在3秒之内都可以缓冲出来（这个时候的即时速度可以到3M/s）。&lt;img src=&quot;/images/scenery.jpg&quot;/&gt;
YouTube 1080p高清测试视频，<a href="https://youtu.be/6v2L2UGZJAM" target="_blank" rel="external">Planet Earth: Amazing nature scenery</a></p>
<h4 id="tcp优化"><a href="#tcp优化" class="header-anchor"></a>30.2.2.1. <a href="#TCP_u4F18_u5316" class="headerlink" title="TCP优化"></a>TCP优化</h4><p>1.修改文件句柄数限制
如果是ubuntu/centos均可修改/etc/sysctl.d/local.conf
找到fs.file-max这一行，修改其值为1024000，并保存退出。然后执行<code>sysctl -p</code>使其生效
修改vi /etc/security/limits.conf文件，加入
<code>bash
*               soft    nofile           512000
*               hard    nofile          1024000</code>
2.修改vi /etc/profile文件，加入
<code>ulimit -SHn 1024000</code>
然后重启服务器执行<code>ulimit -n</code>，查询返回1024000即可。</p>
<p><code>bash
sysctl.conf报错解决方法
修复modprobe的：
rm -f /sbin/modprobe
ln -s /bin/true /sbin/modprobe
修复sysctl的：
rm -f /sbin/sysctl
ln -s /bin/true /sbin/sysctl</code></p>
<h3 id="ss-加密优化"><a href="#ss-加密优化" class="header-anchor"></a>30.2.3. <a href="#ss__u52A0_u5BC6_u4F18_u5316" class="headerlink" title="ss 加密优化"></a>ss 加密优化</h3><ol>
<li>装M2Crypto 这个可以提高SS的加密速度，安装办法：
Debian/Ubuntu
<code>apt-get install python-m2crypto</code>
安装之后重启SS，速度将会有一定的提升</li>
<li>装 gevent 安装 gevent可以提高 Shadowsocks 的性能。
<code>apt-get install python-dev libevent-dev python-setuptools python-gevent easy_install greenlet gevent</code></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.jiaxm.me/2017-07-day/ShiCiGeFu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jxm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-07-day/ShiCiGeFu/" itemprop="url">诗词歌赋</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-19T20:42:00+08:00">
                2017-07-19
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017-07-day/ShiCiGeFu/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017-07-day/ShiCiGeFu/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>落霞与孤鹜齐飞，秋水共长天一色</p>
<p><img src="http://res.cloudinary.com/jiaxm/image/upload/v1500469825/tengwanggexu.jpg" alt="">
&lt;!--more--&gt;</p>
<h1 id="滕王阁序"><a href="#滕王阁序" class="header-anchor"></a>1. <a href="#u300A_u6ED5_u738B_u9601_u5E8F_u300B" class="headerlink" title="《滕王阁序》"></a>《滕王阁序》</h1><p>&emsp;&emsp;南昌（豫章）故郡，洪都新府。星分翼轸，地接衡庐。襟三江而带五湖，控蛮荆而引瓯越。物华天宝，龙光射牛斗之墟；人杰地灵，徐孺下陈蕃之榻。雄州雾列，俊采星驰，台隍枕夷夏之交，宾主尽东南之美。都督阎公之雅望，棨戟遥临；宇文新州之懿范，襜帷暂驻。十旬休假，胜友如云；千里逢迎，高朋满座。腾蛟起凤，孟学士之词宗；紫电青霜，王将军之武库。家君作宰，路出名区；童子何知，躬逢胜饯。
　　时维九月，序属三秋。潦水尽而寒潭清，烟光凝而暮山紫。俨骖騑于上路，访风景于崇阿。临帝子之长洲，得仙人之旧馆。层台耸翠，上出重霄；飞阁流丹，下临无地。鹤汀凫渚，穷岛屿之萦回；桂殿兰宫，列冈峦之体势。披绣闼，俯雕甍，山原旷其盈视，川泽盱其骇瞩。闾阎扑地，钟鸣鼎食之家；舸舰迷津，青雀黄龙之轴。虹销雨霁，彩彻区明。落霞与孤鹜齐飞，秋水共长天一色。渔舟唱晚，响穷彭蠡之滨；雁阵惊寒，声断衡阳之浦。
　　遥襟俯畅，逸兴遄飞。爽籁发而清风生，纤歌凝而白云遏。睢园绿竹，气凌彭泽之樽；邺水朱华，光照临川之笔。四美具，二难并。穷睇眄于中天，极娱游于暇日。
　　天高地迥，觉宇宙之无穷；兴尽悲来，识盈虚之有数。望长安于日下，指吴会于云间。地势极而南溟深，天柱高而北辰远。关山难越，谁悲失路之人？萍水相逢，尽是他乡之客。怀帝阍而不见，奉宣室以何年？
　　嗟乎！时运不济，命运多舛。冯唐易老，李广难封。屈贾谊于长沙，非无圣主；窜梁鸿于海曲，岂乏明时。所赖君子安贫，达人知命。老当益壮，宁移白首之心？穷且益坚，不坠青云之志。酌贪泉而觉爽，处涸辙以犹欢。北海虽赊，扶摇可接；东隅已逝，桑榆非晚。孟尝高洁，空怀报国之心；阮藉猖狂，岂效穷途之哭！
　　勃，三尺微命，一介书生。无路请缨，等终军之弱冠；有怀投笔，慕宗懿之长风。舍簪笏于百龄，奉晨昏于万里。非谢家之宝树，接孟氏之芳邻。他日趋庭，叨陪鲤对；今晨捧袂，喜托龙门。杨意不逢，抚凌云而自惜；钟期既遇，奏流水以何惭？
　　鸣呼！胜地不常，盛筵难再。兰亭已矣，梓泽丘墟。临别赠言，幸承恩于伟饯；登高作赋，是所望于群公。敢竭鄙诚，恭疏短引。一言均赋，四韵俱成。请洒潘江，各倾陆海云尔！
　
　　滕王高阁临江渚，
　　佩玉鸣鸾罢歌舞。
　　画栋朝飞南浦云，
　　珠帘暮卷西山雨。
　
　　闲云潭影日悠悠，
　　物换星移几度秋。
　　阁中帝子今何在？
　　槛外长江空自流。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.jiaxm.me/2017-07-day/Ubuntu_Rescue_Mode_Repair/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jxm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-07-day/Ubuntu_Rescue_Mode_Repair/" itemprop="url">Linux与Windows双系统启动引导恢复</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-18T00:00:00+08:00">
                2017-07-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017-07-day/Ubuntu_Rescue_Mode_Repair/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017-07-day/Ubuntu_Rescue_Mode_Repair/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由grub引导的Linux与Windows共存的双系统环境中，Windows版本更新的时候常会出现grub引导失败，造成系统无法正常启动的问题。这是因为Windows更新的过程中导致MBR损坏导致无法找到/boot/grub部分，无法进一步引导系统。而这种情况下启动界面上会启动<code>grub rescue</code>模式，本文即在此模式下恢复grub引导。
&lt;!--more--&gt;</p>
<h1 id="术语简述"><a href="#术语简述" class="header-anchor"></a>1. <a href="#u672F_u8BED_u7B80_u8FF0" class="headerlink" title="术语简述"></a>术语简述</h1><h2 id="bios"><a href="#bios" class="header-anchor"></a>1.1. <a href="#BIOS" class="headerlink" title="BIOS"></a>BIOS</h2><p>“Basic Input Output System”，中文名称就是”基本输入输出系统”。其实，它是一组固化到计算机内主板上一个ROM芯片上的程序，它保存着计算机最重要的基本输入输出的程序、系统设置信息、开机后自检程序和系统自启动程序。 其主要功能是为计算机提供最底层的、最直接的硬件设置和控制。</p>
<h2 id="mbr"><a href="#mbr" class="header-anchor"></a>1.2. <a href="#MBR" class="headerlink" title="MBR"></a>MBR</h2><p>“Master Boot Record” 硬盘的物理扇区，也叫主引导记录！因为BIOS 很小无法承载启动的运行程序，所以在bios检测到一个硬盘后，将硬盘的0柱面、0磁头、1扇区的内容经过简单判断后， 至内存中的指定位置，然后跳转至这个位置，开始从这个位置运行，大小为512个byte，其中主要存放引导程序和该硬盘的分区表。</p>
<h2 id="grub"><a href="#grub" class="header-anchor"></a>1.3. <a href="#grub" class="headerlink" title="grub"></a>grub</h2><p>“GRand Unified Bootloade” 多重操作系统启动管理器，就是运行这个GRUB之后可以通过它来引导进入其它的系统，包括window以及linux</p>
<p>小结：PC 首先启动到BIOS ，然后检测硬盘的MBR，将MBR这块扇区的内容(也就是写在上面的GRUB)装入内存运行，再通过运行GRUB得到的结果实现新的跳转启动！</p>
<h1 id="出现grub-resuce情况下修复grub2"><a href="#出现grub-resuce情况下修复grub2" class="header-anchor"></a>2. <a href="#u51FA_u73B0grub_resuce_u60C5_u51B5_u4E0B_u4FEE_u590Dgrub2" class="headerlink" title="出现grub resuce情况下修复grub2"></a>出现grub resuce情况下修复grub2</h1><p>grub2分为两部分，一部分写入MBR，另一部分存在linux系统的/boot/grub目录下。出现<code>grub rescue&gt;</code>即MBR部分无法正常运作grub程序，找不到/boot/grub部分，于是启动grub救援模式。</p>
<p>grub rescue命令行有以下可用命令：
set, ls, insmod, root, prefix（设置启动路径）</p>
<ol>
<li>ls查看所有分区，列出：
（hd0），（hd0，msdos8），（hd0，msdos7），（hd0，msdos6），（hd0，msdos5），（hd0，msdos3），（hd0，msdos1）
需要找到ubuntu的安装分区，通过 <code>ls (hd0, msdos4)/boot</code>直到不出现<code>error: unknown filesystem</code></li>
<li>找到之后通过如下命令设置一次性启动参数：
<code>bash
grub rescue&gt;set root=(hd0,msdos8)
grub rescue&gt;set prefix=(hd0,msdos8)/boot/grub
grub rescue&gt;insmod /boot/grub/i386-pc/normal.mod
grub resuce&gt; normal</code>
其中<code>/boot/grub/i386-pc/normal.mod</code>路径是在Ubuntu 17.04的系统下的。</li>
<li>如果/boot/grub没有损坏，就能进入Ubuntu系统正常启动界面。If not， 需要手动引导：
进入grub命令行：
<code>bash
grub&gt; root (hd0,4) ## 指定包含vmlinuz-2.6.18-274.7.1.el5和initrd-2.6.18-274.7.1.el5.img的partition
grub&gt; kernel /boot/vmlinuz-2.6.18-274.7.1.el5 ro root=/dev/sda8 ## root= 是指定包含/sbin/init的partition，即挂载/的partition（以Linux的角度）
grub&gt; initrd /boot/initrd-2.6.18-274.7.1.el5.img ## 据说这项可以省略
grub&gt; boot</code>
在正确进入了ubuntu之后，需要更新MBR的grub部分来适应新的分区情况：
<code>bash
sudo update-grub2 # update /boot/grub/grub.cfg
sudo grub-install /dev/sda # install grub into MBR of Mater Disk</code></li>
</ol>
<h1 id="livecd-修复方法"><a href="#livecd-修复方法" class="header-anchor"></a>3. <a href="#liveCD__u4FEE_u590D_u65B9_u6CD5" class="headerlink" title="liveCD 修复方法"></a>liveCD 修复方法</h1><p>用启动盘进入try ubuntu界面，手动更新grub
<code>bash
sudo update-grub2
sudo grub-install /dev/sda8</code></p>
<p>参考：
1. <a href="http://blog.csdn.net/jscese/article/details/36865449" target="_blank" rel="external">csdn-jscese</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.jiaxm.me/2017-07-day/Linux_Terminal_Shortcuts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jxm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-07-day/Linux_Terminal_Shortcuts/" itemprop="url">Linux命令行快捷键</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-13T00:00:00+08:00">
                2017-07-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017-07-day/Linux_Terminal_Shortcuts/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017-07-day/Linux_Terminal_Shortcuts/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>note: 这些快捷键在xshell5环境下适用
在shell命令终端中，Ctrl+n相当于方向向下的方向键，Ctrl+p相当于方向向上的方向键。
在命令终端中通过它们或者方向键可以实现对历史命令的快速查找。这也是快速输入命令的技巧。
在命令终端中可以通过Ctrl+r 实现快速检索使用过的历史命令。Ctrl+r中r是retrieve中r。</p>
<p>&lt;!--more--&gt;
</p>
<p>Ctrl+a：光标回到命令行首。 （a：ahead）
Ctrl+e：光标回到命令行尾。 （e：end）
Ctrl+b：光标向行首移动一个字符。 （b：backwards）
Ctrl+ f：光标向行尾移动一个字符。 （f：forwards）
Ctrl+w: 删除光标处到行首的字符。
Ctrl+k：删除光标处到行尾的字符。
Ctrl+u：删除整个命令行文本字符。
Ctrl+h：向行首删除一个字符。
Ctrl+d：向行尾删除一个字符。
Ctrl+y:：粘贴Ctrl+u，Ctrl+k，Ctrl+w删除的文本。
Ctrl+p: 上一个使用的历史命令。 （p：previous）
Ctrl+n： 下一个使用的历史命令。（n：next ）
Ctrl+r：快速检索历史命令。（r：retrieve）。
Ctrl+t： 交换光标所在字符和其前的字符。
Ctrl+i：相当于Tab键。
Ctrl+o：相当于Ctrl+m.
Ctrl+m：相当Enter键。
其他控制键：
Ctrl+s:使终端发呆，静止，可以使快速输出的终端屏幕停下来。
Ctrl+q：退出Ctrl+s引起的发呆。
Ctrl+z：使正在运行在终端的任务，运行于后台。 （可用fg恢复）
Ctrl+c：中断终端中正在执行的任务。
Ctrl+d: 在空命令行的情况下可以退出终端。
Ctrl+[ ：相当于Esc键。
Esc键：连续按3次显示所有的支持的终端命令。
Tab键：命令、文件名等自动补全功能。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.jiaxm.me/2017-07-day/python_code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jxm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017-07-day/python_code/" itemprop="url">python3 学习爬虫遇到的一点编码问题</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-02T14:36:06+08:00">
                2017-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017-07-day/python_code/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017-07-day/python_code/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在windows上默认以gbk编码。保存一个文件到本地，会被改成gbk的编码，即使在输出内容在写入到文件前已经做了utf-8的编码，最后还是会被转成gbk编码。
本例中就是从糗百上抓的文本，其本身是utf-8编码的。读取的时候encode用gbk，输出用gbk。既然最后一定要用gbk，那前面就不可以用utf-8来encode，否则会报错，i.e.，有些字符找不到对应的编码。
&lt;!--more--&gt;</p>
<h1 id="python3-学习爬虫遇到的一点编码问题"><a href="#python3-学习爬虫遇到的一点编码问题" class="header-anchor"></a>1. <a href="#python3__u5B66_u4E60_u722C_u866B_u9047_u5230_u7684_u4E00_u70B9_u7F16_u7801_u95EE_u9898" class="headerlink" title="python3 学习爬虫遇到的一点编码问题"></a>python3 学习爬虫遇到的一点编码问题</h1><h2 id="上解决代码"><a href="#上解决代码" class="header-anchor"></a>1.1. <a href="#u4E0A_u89E3_u51B3_u4EE3_u7801_uFF1A" class="headerlink" title="上解决代码："></a>上解决代码：</h2><p>```python</p>
<h1 id="codingutf-8"><a href="#codingutf-8" class="header-anchor"></a>2. <a href="#coding_3D_u2019utf-8_u2019" class="headerlink" title="coding=’utf-8’"></a>coding=’utf-8’</h1><p>import chardet
import requests, re, sys
headers = {
‘User-Agent’: ‘Mozilla/5.0 (Macintosh; Intel Mac OS X 10<em>11</em>\
4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 S\
afari/537.36’}
r = requests.get(“https://www.qiushibaike.com”, headers=headers)
pattern=re.compile(‘&lt;div class=&quot;author.*?&lt;h2&gt;(.*?)&lt;/h2&gt;.*?Icon&quot;&gt;(.<em>?)&lt;/div&gt;.</em>?&lt;div class=&quot;content&quot;&gt;.<em>?&lt;span&gt;(.</em>?)&lt;/span&gt;.<em>?&lt;span.</em>?stats-vote.<em>?number”&gt;(.</em>?)&lt;/i&gt;.<em>?stats-comments.</em>?number”&gt;(.<em>?)&lt;/i&gt;.</em>?up.<em>?number hidden”&gt;(.</em>?)&lt;/span&gt;.<em>?down.</em>?number hidden”&gt;(.*?)&lt;/span&gt;‘,re.S)
items = re.findall(pattern, r.text)
fout = open(“qiubai.txt”, ‘w’)
for i, item in enumerate(items):
    fout.write(“=========================================\n”)
    name = item[0]
    age = int(item[1])
    up = int(item[3])
    comment = int(item[4])
    down = -int(item[-1])
    tot = int(item[5])</p>
<pre><code>s = item[2].split(&quot;&lt;br/&gt;&quot;)
print(item)
for l in s:
    gl = l.encode(&#39;gbk&#39;,&#39;ignore&#39;)
    fout.write(&quot;%s\n&quot;%(gl.decode(&#39;gbk&#39;)))
fout.write(&quot;ID: %s\nAge: %d\n顶: %d\n踩: %d\n评论:%d\n&quot;%(name, age, up, comment, down))
fout.write(&quot;\n&quot;)
</code></pre><p>```</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="jxm" />
          <p class="site-author-name" itemprop="name">jxm</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/jerrymultiscale" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://timchen314.com/" title="大师兄" target="_blank">大师兄</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https:/yangxi1209.github.io/" title="学霸师姐" target="_blank">学霸师姐</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.shirui.me/" title="大仙" target="_blank">大仙</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jxm</span>
</div>

<!--
<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
-->


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问次数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>


        
      </div>
    </footer>

    <!-- 页面点击小红心 -->
    <script type="text/javascript" src="/js/src/love.js"></script>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://jiaxm-me.disqus.com/count.js" async></script>
    

    

  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
